<!-- .row -->
<div class="row" *ngIf="!isLoader">
    <!-- Show if patient is not subscribed -->
    <div *ngIf="isNotSubscribed" class="col-md-12">
        <div class="card">
            <div class="card-body text-center">
                <h3 class="text-danger">Access Restricted</h3>
                <p>{{ errorMessage }}</p>
                <p>Please ensure the patient has an active subscription to view their information.</p>
                <button class="btn btn-primary" (click)="router.navigate(['app/subscription-required'])">
                    Go to Subscription Page
                </button>
                <button class="btn btn-secondary ml-2" (click)="router.navigate(['app/patient'])">
                    Back to Patient List
                </button>
            </div>
        </div>
    </div>

    <!-- Show if patient is subscribed -->
    <div *ngIf="!isNotSubscribed">
        <div class="col-md-4 col-xs-12">
            <div class="card">
                <div class="user-bg"> <img width="100%" [alt]="ImageSrc" [src]="ImageSrc"> </div>
                <div class="card-body">
                    <div class="user-btm-box">
                        <div class="row text-center m-t-10">
                            <div class="col-md-12"><strong>User Name</strong>
                                <p *ngIf="patient?.user">{{patient?.user.username}}</p>
                            </div>
                        </div>
                        <hr>
                        <!-- Rest of your existing user info section -->
                        <div class="row text-center m-t-10">
                            <div class="col-md-6 col-6 b-r"><strong>Name</strong>
                                <p>{{patient?.user.name}}</p>
                            </div>
                            <div class="col-md-6 col-6"><strong>Occupation</strong>
                                <p>{{patient?.occupation}}</p>
                            </div>
                        </div>
                        <hr>
                        <!-- Other sections like Email, Phone, Address -->
                        <button *ngxPermissionsOnly="['hospital']" type="button" class="btn btn-block"
                            [ngClass]="patient?.user.active ? 'btn-outline-primary' : 'btn-outline-success'"
                            (click)="markAsActive()" style="text-align: center;">
                            Mark as {{patient?.user.active ? 'Inactive' : 'Active'}}
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-8 col-xs-12">
            <div class="card">
                <!-- Nav tabs -->
                <div>
                    <ul class="nav nav-tabs profile-tab align-items-center" role="tablist">
                        <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 1}" data-toggle="tab"
                                href="javascript:void(0)" (click)="onclickTab(1)" role="tab">General</a> </li>
                        <li *ngxPermissionsOnly="['patient']" class="nav-item"> <a class="nav-link"
                                [ngClass]="{active: tab === 2}" data-toggle="tab" href="javascript:void(0)"
                                (click)="goToEdit()" role="tab">Update Details</a> </li>
                        <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 3}" data-toggle="tab"
                                href="javascript:void(0)" (click)="onclickTab(3)" role="tab">Reports & Documents</a>
                        </li>
                        <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 4}" data-toggle="tab"
                                href="javascript:void(0)" (click)="onclickTab(4)" role="tab">Billing</a> </li>
                        <li class="ml-auto abc" style="padding-top: 10px; padding-right: 10px;">
                            <button class="btn btn-info d-lg-block m-10" type="button" [routerLink]="['medical']">
                                <i class="fa fa-sticky-note-o" aria-hidden="true"></i> Medical History
                            </button>
                        </li>
                    </ul>
                </div>
                <!-- Tab panes -->
                <div class="tab-content">
                    <div class="tab-pane" [ngClass]="{active: tab === 1}" *ngIf="tab === 1" role="tabpanel">
                        <div class="card-body">
                            <!-- Your existing General tab content -->
                            <div class="row">
                                <div class="col-md-3 col-6 b-r mb-10"> <strong>Status</strong>
                                    <br>
                                    <h4 class="font-medium"><span class="label"
                                            [ngClass]="patient?.user.active ? 'label-success' : 'label-primary'"
                                            style="padding: 10px;"> {{patient?.user.active ? 'Active' :
                                            'Inactive'}}</span>
                                    </h4>
                                </div>
                                <!-- Other General tab content -->
                            </div>
                            <hr>
                            <h3>Biodata</h3>
                            <div class="row">
                                <div class="col-md-3 col-6 b-r mb-10"> <strong>Age</strong>
                                    <br>
                                    <p class="text-muted"> {{patient?.dob | age}}</p>
                                </div>
                                <!-- Other Biodata fields -->
                            </div>
                            <hr>
                            <p>{{patient?.description}}</p>
                            <h3>Vitals</h3>
                            <div *ngIf="patient?.vitalsUpdatedAt">
                                Updated At: {{patient?.vitalsUpdatedAt | date:'MMM d, h:mm a'}}
                            </div>
                            <div *ngFor="let vital of patient?.vitals;">
                                <!-- Your existing vitals display -->
                            </div>
                            <hr>
                            <h3>Past Medical History</h3>
                            <hr>
                            <!-- Your existing accordion for medical history -->
                            <ngb-accordion *ngxPermissionsOnly='["doctor"]' (openChange)='onChnageAccordian()'
                                [closeOthers]="true">
                                <!-- Your existing doctor accordion content -->
                            </ngb-accordion>
                            <ngb-accordion *ngxPermissionsExcept='["doctor"]' (openChange)='onChnageAccordian()'
                                [closeOthers]="true">
                                <!-- Your existing non-doctor accordion content -->
                            </ngb-accordion>
                        </div>
                    </div>
                    <div class="tab-pane" [ngClass]="{active: tab === 3}" *ngIf="tab === 3" role="tabpanel">
                        <app-profile-reports [userId]="patient?.user?._id"
                            [patientId]="patient?._id"></app-profile-reports>
                    </div>
                    <div class="tab-pane" [ngClass]="{active: tab === 4}" *ngIf="tab === 4" role="tabpanel">
                        <app-profile-billing></app-profile-billing>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<loader *ngIf="isLoader"></loader>

<!-- Your existing modal content -->
<ng-template #modalContent let-close="close">
    <!-- Your existing modal content -->
    </ng-template>