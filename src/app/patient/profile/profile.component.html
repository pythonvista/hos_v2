<!-- .row -->
<div class="row" *ngIf="!isLoader">
    <div class="col-md-4 col-xs-12">
        <div class="card">
            <div class="user-bg"> <img width="100%" [alt]="ImageSrc" [src]="ImageSrc"> </div>
            <div class="card-body">
                <div class="user-btm-box">
                    <!-- .row -->
                    <div class="row text-center m-t-10">
                        <div class="col-md-12"><strong>User Name</strong>
                            <p *ngIf="patient?.user">{{patient?.user.username}}</p>
                        </div>

                    </div>
                    <hr>
                    <div class="row text-center m-t-10">
                        <div class="col-md-6 col-6 b-r"><strong>Name</strong>
                            <p>{{patient?.user.name}}</p>
                        </div>
                        <div class="col-md-6 col-6"><strong>Occupation</strong>
                            <p>{{patient?.occupation}}</p>
                        </div>
                    </div>
                    <!-- /.row -->
                    <hr>
                    <!-- .row -->
                    <div class="row text-center m-t-10">
                        <div class="col-md-6 col-6 b-r"><strong>Email ID</strong>
                            <p>{{patient?.user.email}}</p>
                        </div>
                        <div class="col-md-6 col-6"><strong>Phone</strong>
                            <p>{{patient?.user.phone}}</p>
                        </div>
                    </div>
                    <!-- /.row -->
                    <hr>
                    <!-- .row -->
                    <div class="row text-center m-t-10">
                        <div class="col-md-12"><strong>Address</strong>
                            <p *ngIf="patient?.user">{{patient?.user | address}}</p>
                        </div>

                    </div>
                    <hr>
                    <button *ngxPermissionsOnly="['hospital']" type="button" class="btn  btn-block "
                        [ngClass]="patient?.user.active ? 'btn-outline-primary' : 'btn-outline-success'"
                        (click)="markAsActive()" style="text-align: center;">
                        Mark as {{patient?.user.active ? 'Inactive' : 'Active'}}
                    </button>
                    <!-- <button type="button" class="btn btn-outline-success btn-block " (click)="onOpen()" data-toggle="modal" data-target="#modalContent" style="text-align: center;">Refer
                        To <i class="fas fa-arrow-right "></i> </button> -->
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-8 col-xs-12">
        <div class="card">
            <!-- Nav tabs -->
            <div>
                <ul class="nav nav-tabs profile-tab align-items-center" role="tablist">
                    <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 1}" data-toggle="tab"
                            href="javascript::void(0)" (click)="onclickTab(1)" role="tab">General</a> </li>
                    <li *ngxPermissionsOnly="['patient']" class="nav-item"> <a class="nav-link"
                            [ngClass]="{active: tab === 2}" data-toggle="tab" href="javascript::void(0)"
                            (click)="goToEdit()" role="tab">Update Details</a> </li>
                    <!-- <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 2}" data-toggle="tab"
                        href="javascript::void(0)" (click)="onclickTab(2)" role="tab">Medical History</a> </li> -->
                    <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 3}" data-toggle="tab"
                            href="javascript::void(0)" (click)="onclickTab(3)" role="tab">Reports & Documents</a> </li>
                    <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 4}" data-toggle="tab"
                            href="javascript::void(0)" (click)="onclickTab(4)" role="tab">Billing</a> </li>
                    <!-- <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 5}" data-toggle="tab"
                            href="javascript::void(0)" (click)="onclickTab(5)" role="tab">Visits</a> </li> -->
                    <!-- <li class="nav-item"> <a class="nav-link" [ngClass]="{active: tab === 6}" data-toggle="tab"
                        href="javascript::void(0)" (click)="onclickTab(6)" role="tab">Comments</a> </li> -->
                    <li class="ml-auto abc" style="padding-top: 10px; padding-right: 10px ;">
                        <button class="btn btn-info d-lg-block m-10" type="button" [routerLink]="['medical']"> <i
                                class="fa fa-sticky-note-o" aria-hidden="true"></i>&nbsp;&nbsp;<a>Medical
                                History</a></button>
                    </li>
                </ul>
            </div>
            <!-- Tab panes -->
            <div class="tab-content">
                <div class="tab-pane " [ngClass]="{active: tab === 1}" *ngIf="tab === 1" role="tabpanel">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3 col-6 b-r mb-10"> <strong>Status</strong>
                                <br>
                                <h4 class="font-medium"><span class="label "
                                        [ngClass]="patient?.user.active ? 'label-success' : 'label-primary'"
                                        style="padding: 10px;"> {{patient?.user.active ? 'Active' : 'Inactive'}}</span>
                                </h4>

                            </div>
                            <div class="col-md-3 col-6 b-r mb-10 h-b"> <strong>Date of Birth</strong>
                                <br>
                                <p class="text-muted">{{patient?.dob | date: 'longDate'}}</p>
                            </div>
                            <div class="col-md-3 col-6 b-r"> <strong>Member Since</strong>
                                <br>
                                <p class="text-muted"> {{patient?.user.createdAt | date : 'longDate'}}</p>
                            </div>
                            <div class="col-md-3 col-6"> <strong>Pending Dues</strong>
                                <br>
                                <p class="text-muted">Detailed</p>
                            </div>

                        </div>
                        <hr>
                        <h3>Biodata</h3>
                        <div class="row">
                            <div class="col-md-3 col-6 b-r mb-10"> <strong>Age</strong>
                                <br>
                                <p class="text-muted"> {{patient?.dob | age}}</p>
                            </div>
                            <div class="col-md-3 col-6 b-r mb-10 h-b"> <strong>Tribe</strong>
                                <br>
                                <p class="text-muted">{{patient?.tribe }}</p>
                            </div>
                            <div class="col-md-3 col-6 b-r"> <strong>Religion</strong>
                                <br>
                                <p class="text-muted"> {{patient?.religion}}</p>
                            </div>
                            <div class="col-md-3 col-6"> <strong>Marital Status</strong>
                                <br>
                                <p class="text-muted"> {{patient?.maritalStatus}}</p>
                            </div>

                        </div>
                        <hr>
                        <p>{{patient?.description}}</p>

                        <!-- Vitals -->
                        <h3>Vitals

                        </h3>
                        <div *ngIf="patient?.vitalsUpdatedAt">
                            Updated At: {{patient?.vitalsUpdatedAt |date:'MMM d, h:mm a'}}
                        </div>
                        <div *ngFor="let vital of patient?.vitals;">
                            <hr>
                            <h5 *ngIf="vital?.name==='temprature'"> <b> {{vital.name}} </b>:
                                <span *ngIf='checkTemprature(vital?.value)' class="text-danger">{{vital.value }}</span>
                                <span *ngIf='!checkTemprature(vital?.value)'>{{vital.value }}</span>
                                <span>&#8451;</span>
                            </h5>

                            <h5 *ngIf="vital?.name==='pulseRate'"> <b> {{vital.name}} </b>:
                                <span *ngIf='checkPulseRate(vital?.value)' class="text-danger">{{vital.value }} </span>
                                <span *ngIf='!checkPulseRate(vital?.value)'>{{vital.value }} </span>
                                <span>beats per min</span>
                            </h5>

                            <h5 *ngIf="vital?.name==='pulseVolume'"> <b> {{vital.name}} </b>:
                                <span>{{vital.value}}
                                </span>
                            </h5>

                            <h5 *ngIf="vital?.name==='pulseRhythm'"> <b> {{vital.name}} </b>:
                                <span>{{vital.value}}
                                </span>
                            </h5>

                            <h5 *ngIf="vital?.name==='pulseEquality'"> <b> {{vital.name}} </b>:
                                <span>{{vital.value}}
                                </span>
                            </h5>

                            <h5 *ngIf="vital?.name==='respiratoryRate'"> <b> {{vital.name}} </b>:
                                <span *ngIf='checkCyclesPerMin(vital?.value)' class="text-danger">{{vital.value
                                    }}</span>
                                <span *ngIf='!checkCyclesPerMin(vital?.value)'>{{vital.value }} </span>
                                <span>cycles per min</span>
                            </h5>

                            <h5 *ngIf="vital?.name==='systolic'"> <b> {{vital.name}} </b>:
                                <span *ngIf='checkSystolic(vital?.value)' class="text-danger">{{vital.value }}</span>
                                <span *ngIf='!checkSystolic(vital?.value)'>{{vital.value }} </span>
                                <span>mmhg</span>
                            </h5>

                            <h5 *ngIf="vital?.name==='diastolic'"> <b> {{vital.name}} </b>:
                                <span *ngIf='checkDiastolic(vital?.value)' class="text-danger">{{vital.value }}</span>
                                <span *ngIf='!checkDiastolic(vital?.value)'>{{vital.value }} </span>
                                <span>mmhg</span>
                            </h5>

                            <h5 *ngIf="vital?.name==='height'"> <b> {{vital.name}} </b>:
                                <span>{{vital.value}} meter
                                </span>
                            </h5>
                            <h5 *ngIf="vital?.name==='weight'"> <b> {{vital.name}} </b>:
                                <span>{{vital.value}} kg
                                </span>
                            </h5>
                            <h5 *ngIf="vital?.name==='bmi'"> <b> {{vital.name}} </b>:
                                <span>{{vital.value}}
                                </span>
                            </h5>

                            <h5 *ngIf="vital?.name==='oxygensaturation'"> <b> {{vital.name}} </b>:
                                <span *ngIf='checkOxygen(vital?.value)' class="text-danger">{{vital.value }}</span>
                                <span *ngIf='!checkOxygen(vital?.value)'>{{vital.value }} </span>
                                <span>%</span>
                            </h5>

                        </div>
                        <hr>
                        <!-- <div class="stats-row">
                            <div class="stat-item" *ngFor="let vi of horizontalVitals">
                                <h6 class="text-warning">{{vi.text}}</h6>
                                <p>{{vi.value}}</p>
                            </div>

                        </div> -->

                        <h3>Past Medical History</h3>
                        <hr>

                        <!--  Fix diseses Accordian -->
                        <ngb-accordion *ngxPermissionsOnly='["doctor"]' (openChange)='onChnageAccordian()'
                            [closeOthers]="true">
                            <ngb-panel id="acd-1" title="Problems/Past Medical History">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <angular-editor (click)='isButtonVisible = true' [config]="editorConfig"
                                            [placeholder]="'Problems/Past Medical History'"
                                            [(ngModel)]="problems_PastMedicalHistoryValue"></angular-editor>
                                        <a *ngIf="isButtonVisible"
                                            (click)='onSaveDiseaseChange("problems_PastMedicalHistory",problems_PastMedicalHistoryValue)'
                                            type="submit" class="btn btn-info mt-3 text-white waves-effect"
                                            data-dismiss="modal">Save
                                            changes</a>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-2" title="Drug History">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <angular-editor (click)='isButtonVisible = true' [config]="editorConfig"
                                            [placeholder]="'Drug History'" [(ngModel)]="drugHistoryValue">
                                        </angular-editor>
                                        <a *ngIf="isButtonVisible"
                                            (click)='onSaveDiseaseChange("drugHistory",drugHistoryValue)' type="submit"
                                            class="btn btn-info mt-3  text-white waves-effect" data-dismiss="modal">Save
                                            changes</a>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-3" title="Surgical History">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <angular-editor (click)='isButtonVisible = true' [config]="editorConfig"
                                            [placeholder]="'Surgical History'" [(ngModel)]="surgicalHistoryValue">
                                        </angular-editor>

                                        <a *ngIf="isButtonVisible"
                                            (click)='onSaveDiseaseChange("surgicalHistory",surgicalHistoryValue)'
                                            type="submit" class="btn btn-info mt-3  text-white waves-effect"
                                            data-dismiss="modal">Save
                                            changes</a>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-4" title="Obstetrics and gynacology History">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <angular-editor (click)='isButtonVisible = true' [config]="editorConfig"
                                            [placeholder]="'Obstetrics and gynacology History'"
                                            [(ngModel)]="obstetrics_GynacologyHistoryValue"></angular-editor>
                                        <a *ngIf="isButtonVisible"
                                            (click)='onSaveDiseaseChange("obstetrics_GynacologyHistory",obstetrics_GynacologyHistoryValue)'
                                            type="submit" class="btn btn-info mt-3  text-white waves-effect"
                                            data-dismiss="modal">Save
                                            changes</a>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-5" title="Vaccines">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <angular-editor (click)='isButtonVisible = true' [config]="editorConfig"
                                            [placeholder]="'vaccines'" [(ngModel)]="vaccinesValue"></angular-editor>
                                        <a *ngIf="isButtonVisible"
                                            (click)='onSaveDiseaseChange("vaccines",vaccinesValue)' type="submit"
                                            class="btn btn-info mt-3  text-white waves-effect" data-dismiss="modal">Save
                                            changes</a>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-6" title="Allergies">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <angular-editor (click)='isButtonVisible = true' [config]="editorConfig"
                                            [placeholder]="'Allergies'" [(ngModel)]="allergiesValue"></angular-editor>
                                        <a *ngIf="isButtonVisible"
                                            (click)='onSaveDiseaseChange("allergies", allergiesValue)' type="submit"
                                            class="btn btn-info mt-3  text-white waves-effect" data-dismiss="modal">Save
                                            changes</a>
                                    </div>
                                </ng-template>
                            </ngb-panel>
                        </ngb-accordion>

                        <!-- History View for other than doctor -->
                        <ngb-accordion *ngxPermissionsExcept='["doctor"]' (openChange)='onChnageAccordian()'
                            [closeOthers]="true">
                            <ngb-panel id="acd-1" title="Problems/Past Medical History">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <p [innerHTML]="problems_PastMedicalHistoryValue"></p>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-2" title="Drug History">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <p [innerHTML]="drugHistoryValue"></p>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-3" title="Surgical History">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <p [innerHTML]="surgicalHistoryValue"></p>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-4" title="Obstetrics and gynacology History">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <p [innerHTML]="obstetrics_GynacologyHistoryValue"></p>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-5" title="Vaccines">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <p [innerHTML]="vaccinesValue"></p>
                                    </div>
                                </ng-template>
                            </ngb-panel>

                            <ngb-panel id="acd-6" title="Allergies">
                                <ng-template ngbPanelContent>
                                    <div class="col-md-12 mt-3">
                                        <p [innerHTML]="allergiesValue"></p>
                                    </div>
                                </ng-template>
                            </ngb-panel>
                        </ngb-accordion>


                        <!-- <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries </p> -->
                        <!-- <p>It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p> -->

                    </div>
                </div>

                <div class="tab-pane " [ngClass]="{active: tab === 3}" *ngIf="tab === 3" role="tabpanel">
                    <app-profile-reports [userId]="patient?.user?._id" [patientId]="patient?._id"></app-profile-reports>
                </div>
                <div class="tab-pane " [ngClass]="{active: tab === 4}" *ngIf="tab === 4" role="tabpanel">
                    <app-profile-billing></app-profile-billing>
                </div>
                <div class="tab-pane " [ngClass]="{active: tab === 5}" *ngIf="tab === 5" role="tabpanel">
                    <app-profile-visits></app-profile-visits>
                </div>
                <div class="tab-pane " [ngClass]="{active: tab === 6}" *ngIf="tab === 6" role="tabpanel">
                    <app-profile-comments></app-profile-comments>
                </div>
            </div>
        </div>
    </div>
</div>
<loader *ngIf="isLoader"></loader>
<!-- /.row -->

<ng-template #modalContent let-close="close">
    <div class="modal-header">
        <h5 class="modal-title text-primary">Referral Forms</h5>
        <button type="button" class="close" (click)="onClose()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <h4 class="card-subtitle"> Reffer To : </h4>
        <form class="form-horizontal mt-4">
            <div class="form-group">
                <label class=" mb-3">Hospital </label>
                <input type="text" class="form-control" value="Elite Hospital">
            </div>
            <div class="form-group">
                <label class=" mb-3">Department</label>
                <input type="text" class="form-control" placeholder="Cardiology">
            </div>
            <div class="form-group">
                <label class=" mb-3">Doctor</label>
                <input type="text" class="form-control" value="Doctor John">
            </div>

            <div class="form-group">
                <label class=" mb-3">Reason</label>
                <textarea class="form-control" rows="5"></textarea>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-success"
            (click)="onClose();showNotification( 'success', 'Referred to Dr. Albert.' )">
            Submit
        </button>
    </div>
</ng-template>